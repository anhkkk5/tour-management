/api/v1/auth/register:
  post:
    tags:
      - Auth
    summary: Đăng ký tài khoản (gửi OTP, chưa tạo user trong DB)
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
              - password
            properties:
              email:
                type: string
                example: test1@gmail.com
              password:
                type: string
                example: "123456"
              fullName:
                type: string
                example: Test User
              phone:
                type: string
                example: "0900000000"
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: OTP sent
                email:
                  type: string
                otp:
                  type: string
                  example: "123456"
                  description: Chỉ trả về ở môi trường dev (NODE_ENV != production)
                expiresInSeconds:
                  type: integer
                  example: 300

/api/v1/auth/reset-password/verify-otp:
  post:
    tags:
      - Auth
    summary: Quên mật khẩu - xác thực OTP để lấy resetToken
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
              - otp
            properties:
              email:
                type: string
                example: test1@gmail.com
              otp:
                type: string
                example: "123456"
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Verify OTP success
                resetToken:
                  type: string
                expiresInSeconds:
                  type: integer
                  example: 300

/api/v1/auth/reset-password/request-otp:
  post:
    tags:
      - Auth
    summary: Quên mật khẩu - gửi OTP về email
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
            properties:
              email:
                type: string
                example: test1@gmail.com
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: OTP sent
                email:
                  type: string
                otp:
                  type: string
                  example: "123456"
                  description: Chỉ trả về ở môi trường dev (NODE_ENV != production)
                expiresInSeconds:
                  type: integer
                  example: 300

/api/v1/auth/reset-password:
  post:
    tags:
      - Auth
    summary: Quên mật khẩu - dùng resetToken để đổi mật khẩu
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - resetToken
              - newPassword
            properties:
              resetToken:
                type: string
              newPassword:
                type: string
                example: "newStrongPassword123"
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Reset password success

/api/v1/auth/register/verify-otp:
  post:
    tags:
      - Auth
    summary: Xác thực OTP đăng ký (tạo user trong DB + trả token)
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
              - otp
            properties:
              email:
                type: string
                example: test1@gmail.com
              otp:
                type: string
                example: "123456"
    responses:
      "200":
        description: OK
        headers:
          Set-Cookie:
            schema:
              type: string
            description: refreshToken cookie (httpOnly)
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Register success
                accessToken:
                  type: string
                user:
                  type: object

/api/v1/auth/register/resend-otp:
  post:
    tags:
      - Auth
    summary: Gửi lại OTP đăng ký (khi OTP hết hạn/chưa nhập OTP)
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
            properties:
              email:
                type: string
                example: test1@gmail.com
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: OTP resent
                email:
                  type: string
                otp:
                  type: string
                  example: "123456"
                  description: Chỉ trả về ở môi trường dev (NODE_ENV != production)
                expiresInSeconds:
                  type: integer
                  example: 300

/api/v1/auth/login:
  post:
    tags:
      - Auth
    summary: Đăng nhập
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - email
              - password
            properties:
              email:
                type: string
                example: test1@gmail.com
              password:
                type: string
                example: "123456"
    responses:
      "200":
        description: OK
        headers:
          Set-Cookie:
            schema:
              type: string
            description: refreshToken cookie (httpOnly)
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Login success
                accessToken:
                  type: string
                user:
                  type: object

/api/v1/auth/refresh:
  post:
    tags:
      - Auth
    summary: Refresh access token (dùng refreshToken cookie)
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Refresh success
                accessToken:
                  type: string

/api/v1/auth/logout:
  post:
    tags:
      - Auth
    summary: Logout (xóa refreshToken)
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Logout success

/api/v1/auth/otp/request:
  post:
    tags:
      - Auth
    summary: Tạo OTP xác thực email cho user đã đăng nhập (cần access token)
    security:
      - bearerAuth: []
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: OTP generated
                otp:
                  type: string
                  example: "123456"
                expiresInSeconds:
                  type: integer
                  example: 300

/api/v1/auth/otp/verify:
  post:
    tags:
      - Auth
    summary: Xác thực OTP email cho user đã đăng nhập (cần access token)
    security:
      - bearerAuth: []
    requestBody:
      required: true
      content:
        application/json:
          schema:
            type: object
            required:
              - otp
            properties:
              otp:
                type: string
                example: "123456"
    responses:
      "200":
        description: OK
        content:
          application/json:
            schema:
              type: object
              properties:
                code:
                  type: integer
                  example: 200
                message:
                  type: string
                  example: Verify OTP success
